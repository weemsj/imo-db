{% extends "main.j2" %}
{% block title %}Employees{% endblock %} 
{% set active_page = "employees" %}
{% block content %}
    <h1> Employees </h1>
    <h3> This page shows all the employees at IMO Fitness. Use the below form to search, add, modify, or delete employees </h3></center><br>
	
	<form id="employee_search" action="/employee_search" method="POST">
		<input type="text" name="emp_search" id="emp_search" onkeyup="emp_search()" placeholder="Last name search..." title="name search" required>
	<input type="submit">
	</form>
	<div id=insert-right>
        <button type="button"><a href="add_employee">Add Employee</a></button>
    </div>
	<br><br>

    <div style="overflow-x:auto" class="table">
        <table class="nostretch" id= "emp_table" border="1">
        <thead class="table-head">
            {% for key in entity[0].keys() %}
    
            <th id="thead">{{ key }}</th>
    
            {% endfor %}
        </thead>
        <tbody>
            {% for data in entity %}
            <tr>
                {% for key in data.keys() %}
                <td>{{data[key]}}</td>
                {% endfor %}
                <td><input type="button" value="details" onclick="window.location.href='{{ url_for('emp_details', emp_id=data.emp_id) }}';"></td>
                <td><input type='button' value="edit" onclick="window.location.href='{{ url_for('update_employee', emp_id=data.emp_id) }}';" ></td>
                <td><input type='button' value="delete" onclick="window.location='/delete_employee/{{ data.emp_id }}'"></td>
            </tr>
            {% endfor %}
        </tbody>
        </table>
	</div>
    <div>
        <button type="button"><a href="add_employee">Add Employee</a></button>
    </div>

{% endblock %}
<script>
    function emp_search() {
        // Declare variables
        let input, filter, table, tr, td, i, txtValue;
        input = document.getElementById("emp_search");
        filter = input.value.toUpperCase();
        table = document.getElementById("emp_table");
        tr = table.getElementsByTagName("tr");

        // Loop through all table rows, and hide those who don't match the search query
        for (i = 0; i < tr.length; i++) {
            td = tr[i].getElementsByTagName("td")[2];
            if (td) {
                txtValue = td.textContent || td.innerText;
                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                } else {
                    tr[i].style.display = "none";
                }
            }
        }
    }
</script>