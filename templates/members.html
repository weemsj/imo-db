{% extends "main.j2" %}
{% block title %}Members{% endblock %}
{% set active_page = 'members' %}
{% block content %}

    <h1> Members </h1>
    <h3> This page shows all {{ view }} at IMO Fitness. Use the below form to search, add, modify, or delete
        members </h3><br>

    <!-- add filter option for view of active and not active members -->
    <form id="members_search" action="/members_search" method="POST">
        <input type="text" name="mem_search" id="mem_search" onkeyup="mem_search()" placeholder="Last name search..."
               title="name search" required>
        <input type="submit">
    </form>
    <div id=insert-right>
        <button type="button"><a href="add_member">Add member</a></button>
    </div>
    <br><br>

    <div style="overflow-x:auto" class="table">
        <table class="nostretch" id="mem_table" border="1">
            <thead>
            {% for key in entity[0].keys() %}

                <th id="thead">{{ key }}</th>

            {% endfor %}
            </thead>
            <tbody>
            {% for data in entity %}
                <tr>
                    {% for key in data.keys() %}
                        <td>{{ data[key] }}</td>
                    {% endfor %}
                    <td><input type="button" value="more details"
                               onclick="window.location.href='{{ url_for('member_details', member_id=data.member_id) }}';">
                    </td>
                    <td><input type="button" value="classes"
                               onclick="window.location.href='{{ url_for('enrolled_classes', member_id=data.member_id) }}';">
                    </td>
                    {# link to view all classes member is enrolled in #}
                    <td><input type="button" value="edit"
                               onclick="window.location.href='{{ url_for('update_member', member_id=data.member_id) }}';">
                    </td>
                    <td><input type="button" value="delete"
                               onclick="window.location='/delete_member?member_id={{ data.member_id }}'"></td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
    <div>
        <button type="button"><a href="add_member">Add member</a></button>
    </div>
    <script type="text/javascript">
        function mem_search() {
            // Declare variables
            let input, filter, table, tblr, tbld, i, txtValue;
            input = document.getElementById("mem_search");
            filter = input.value.toUpperCase();
            table = document.getElementById("mem_table");
            tblr = table.getElementsByTagName("tr");

            // Loop through all table rows, and hide those who don't match the search query
            for (i = 0; i < tblr.length; i++) {
                tbld = tblr[i].getElementsByTagName("td")[2];
                if (tbld) {
                    txtValue = tbld.textContent || tbld.innerText;
                    if (txtValue.toUpperCase().indexOf(filter) > -1) {
                        tblr[i].style.display = "";
                    } else {
                        tblr[i].style.display = "none";
                    }
                }
            }
        }
    </script>

{% endblock %}